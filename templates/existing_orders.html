<style>
/* Orders Table Styling */
.orders-table {
    width: 100%;
    max-width: 100%;
    overflow-x: auto;
    margin-top: 20px;
}

.orders-table table {
    width: 100%;
    border-collapse: collapse;
}

.orders-table th, .orders-table td {
    padding: 15px;
    text-align: left;
    border: 1px solid #ddd;
    white-space: nowrap;
}

.orders-table th {
    background-color: #007bff;
    color: white;
}

.orders-table td input {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

.update-button {
    background-color: #17a2b8;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.update-button:hover {
    background-color: #138496;
}

.pagination {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 10px;
}

.pagination a {
    padding: 10px 15px;
    border: 1px solid #007bff;
    background-color: white;
    color: #007bff;
    text-decoration: none;
    border-radius: 4px;
}

.pagination a:hover {
    background-color: #007bff;
    color: white;
}

.pagination span {
    padding: 10px 15px;
    color: #333;
}

.search-container {
    display: flex;
    justify-content: center;
    margin: 20px 0;
}

.search-form {
    display: flex;
    width: 100%;
    max-width: 600px;
    border: 1px solid #ccc;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.search-input {
    flex-grow: 1;
    padding: 12px;
    border: none;
    outline: none;
    font-size: 16px;
}

.search-button {
    padding: 12px 20px;
    background-color: #007bff;
    border: none;
    color: white;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.search-button:hover {
    background-color: #0056b3;
}

/* Clear Button Styling */
.clear-button {
    padding: 12px 20px;
    background-color: #f44336;
    border: none;
    color: white;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.clear-button:hover {
    background-color: #c62828;
}

/* Home Link Styling for Top-Right Corner */
.home-link-container {
    position: absolute;
    top: 20px;  /* Distance from the top */
    right: 20px;  /* Distance from the right */
    z-index: 1000; /* Ensure it stays above other elements */
}

.home-link {
    display: inline-block;
    padding: 12px 25px;
    background-color: #28a745; /* Success green color */
    color: white;

    font-weight: bold;
    border-radius: 5px;
    transition: background-color 0.3s, transform 0.2s;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
}

.home-link:hover {
    background-color: #218838; /* Darker green on hover */
    transform: scale(1.05); /* Slightly larger on hover */
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15); /* Deeper shadow on hover */
}

.home-link i {
    margin-right: 8px; /* Space between icon and text */
}

.home-link:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(72, 180, 97, 0.5); /* Focus glow effect */
}




</style>
<!-- Home Link in Bottom-Right Corner -->
<div class="home-link-container">
    <a href="{{ url_for('workers') }}" class="home-link">
        <i class="fas fa-back"></i> back
    </a>
</div>
<!-- Search Form -->
<div class="search-container">
    <form method="GET" action="{{ url_for('existing_orders') }}" class="search-form">
        <input type="text" name="query" placeholder="Search by Order ID or Customer Name" value="{{ query }}" class="search-input">
        <button type="submit" class="search-button">
            <i class="fas fa-search"></i> Search
        </button>
        <button type="button" class="clear-button" onclick="clearSearch()">
            <i class="fas fa-times"></i> Clear
        </button>
    </form>
</div>

<!-- Existing Orders Table -->
<div class="orders-table">
    <h3>Existing Orders</h3>
    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>UPIC ID</th>
                <th>Carta ID</th>
                <th>Maqaa abbaa qabiyyee</th>
                <th>Shape of Carta</th>
                <th>Balâ€™ina Kaarta</th>
                <th>Status</th>
                <th>Last Updated</th>
                <th>Updated By</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders.items %}
            <tr>
                <form method="POST" action="{{ url_for('update_order', order_id=order.id) }}">
                    <td>{{ loop.index + (orders.page - 1) * orders.per_page }}</td>
                    <td><input type="text" name="order_id" value="{{ order.order_id }}" required></td>
                    <td><input type="text" name="carta_id" value="{{ order.carta_id }}" required></td>
                    <td><input type="text" name="customer_name" value="{{ order.customer_name }}" required></td>
                    <td><input type="text" name="shape_of_carta" value="{{ order.shape_of_carta }}" required></td>
                    <td><input type="text" name="width_of_carta" value="{{ order.width_of_carta }}" required></td>
                    <td><input type="text" name="status" value="{{ order.status }}" required></td>
                    <td>
                        <abbr title="{{ order.updated_at.strftime('%d %B %Y, %H:%M:%S') }}">
                            {{ order.updated_at.strftime('%d %b %Y') }}
                        </abbr>
                    </td>
                    <td>{{ order.updated_by }}</td>
                    <td>
                        <button type="submit" class="update-button" title="Update Order">
                            <i class="fas fa-sync"></i> Update
                        </button>
                    </td>
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination -->
<div class="pagination">
    {% if orders.has_prev %}
        <a href="{{ url_for('existing_orders', page=orders.prev_num, query=query) }}">&laquo; Previous</a>
    {% endif %}

    <span>Page {{ orders.page }} of {{ orders.pages }}</span>

    {% if orders.has_next %}
        <a href="{{ url_for('existing_orders', page=orders.next_num, query=query) }}">Next &raquo;</a>
    {% endif %}
</div>


<script>
    // Save scroll position in sessionStorage before the page reloads
window.addEventListener('beforeunload', function() {
    sessionStorage.setItem('scrollPosition', window.scrollY);
});

// Restore the scroll position from sessionStorage on page load
window.addEventListener('load', function() {
    var scrollPosition = sessionStorage.getItem('scrollPosition');
    if (scrollPosition) {
        window.scrollTo(0, parseInt(scrollPosition));
        sessionStorage.removeItem('scrollPosition');
    }
});

// Dynamically update the row numbers
document.addEventListener('DOMContentLoaded', function () {
    var tableBody = document.querySelector('.orders-table tbody');
    var rows = tableBody.querySelectorAll('tr');

    rows.forEach((row, index) => {
        var numberCell = row.querySelector('td:first-child');
        numberCell.textContent = index + 1;
    });
});

    // Clear the search input and reload the page without query parameters
function clearSearch() {
    const searchInput = document.querySelector('.search-input');
    searchInput.value = '';
    window.location.href = "{{ url_for('existing_orders') }}";  // Redirect to reset search
}

// Optional smooth scroll to the top when clicking on Home link
document.querySelector('.home-link').addEventListener('click', function(event) {
    event.preventDefault();
    const homeUrl = this.getAttribute('href');
    window.scrollTo({ top: 0, behavior: 'smooth' });
    setTimeout(() => {
        window.location.href = homeUrl;
    }, 500); // Adjust the timing as needed
});
</script>